@tailwind base;
@tailwind components;
@tailwind utilities;

/* --- GLOBAL STYLES & THEME "THIÊN MỆNH NGỌC TỶ" --- */
:root {
  /* Default Theme: Thiên Mệnh Ngọc Tỷ */
  --font-family-body: 'Noto Serif', serif;
  --font-family-title: 'ZCOOL XiaoWei', serif;
  --font-family-calligraphy: 'Ma Shan Zheng', cursive;

  --bg-color: #181D1B;
  --text-color: #EAE7DC;
  --text-muted-color: #8A8981;
  --primary-accent-color: #D4AF37; /* Gold */
  --primary-accent-text-color: #181D1B;
  --secondary-accent-color: #7dcfff; /* Cyan */
  --panel-border-color: #2A322F;
  --input-focus-ring-color: #D4AF37;
  
  --shadow-light: #2A322F;
  --shadow-dark: #0C100E;

  --success-color: #2dd4bf;
  --error-color: #f87171;

  /* Neumorphic shadow definitions */
  --shadow-raised: -6px -6px 12px var(--shadow-light), 6px 6px 12px var(--shadow-dark);
  --shadow-pressed: inset -4px -4px 8px var(--shadow-light), inset 4px 4px 8px var(--shadow-dark);
  --shadow-raised-interactive: -4px -4px 8px var(--shadow-light), 4px 4px 8px var(--shadow-dark);
}

/* --- THEME PALETTES --- */
/* Ngọc Hư Cung (Default - Thiên Mệnh Ngọc Tỷ) */
.theme-ngoc-hu-cung { /* This is the root theme */ }

/* Bích Du Cung (Jade Palace) */
.theme-bich-du-cung {
  --bg-color: #2A3F3A;
  --text-color: #E0EFEA;
  --text-muted-color: #8AA39A;
  --primary-accent-color: #A0DEC4;
  --primary-accent-text-color: #1C2925;
  --secondary-accent-color: #82e9de;
  --panel-border-color: #38554F;
  --input-focus-ring-color: #A0DEC4;
  --shadow-light: #38554F;
  --shadow-dark: #1C2925;
}

/* Thủy Mặc Trúc Lâm (Ink Wash Bamboo) */
.theme-ink-wash-bamboo {
  --bg-color: #282828;
  --text-color: #E5E5E5;
  --text-muted-color: #909090;
  --primary-accent-color: #FFFFFF;
  --primary-accent-text-color: #1A1A1A;
  --secondary-accent-color: #b0b0b0;
  --panel-border-color: #363636;
  --input-focus-ring-color: #FFFFFF;
  --shadow-light: #363636;
  --shadow-dark: #1A1A1A;
}

/* Bình Minh (Sunrise Peak - Light Theme) */
.theme-sunrise-peak {
  --bg-color: #E0E5EC;
  --text-color: #333745;
  --text-muted-color: #5B6478;
  --primary-accent-color: #FF8A8A;
  --primary-accent-text-color: #FFFFFF;
  --secondary-accent-color: #6B7AFF;
  --panel-border-color: #c8d0e7;
  --input-focus-ring-color: #FF8A8A;
  --shadow-light: #FFFFFF;
  --shadow-dark: #A3B1C6;
}

/* Huyết Sát Ma Điện (Blood Devil Palace) */
.theme-huyet-sat-ma-dien {
  --bg-color: #2C1D1F;
  --text-color: #F2E9E9;
  --text-muted-color: #A38E90;
  --primary-accent-color: #E53E3E;
  --primary-accent-text-color: #FFFFFF;
  --secondary-accent-color: #f56565;
  --panel-border-color: #3C282B;
  --input-focus-ring-color: #E53E3E;
  --shadow-light: #3C282B;
  --shadow-dark: #1C1213;
}

/* Thôn Phệ Tinh Hà (Swallowed Star) */
.theme-thon-phe-tinh-ha {
  --bg-color: #1A1A2E;
  --text-color: #E0E1DD;
  --text-muted-color: #8C8D9E;
  --primary-accent-color: #E94560;
  --primary-accent-text-color: #FFFFFF;
  --secondary-accent-color: #0F3460;
  --panel-border-color: #272844;
  --input-focus-ring-color: #E94560;
  --shadow-light: #272844;
  --shadow-dark: #0D0D17;
}

/* Cyber Tu Chân */
.theme-cyber-cultivation-city {
  --bg-color: #0b0c1e;
  --text-color: #c5c6c7;
  --text-muted-color: #66fcf1;
  --primary-accent-color: #45a29e;
  --primary-accent-text-color: #0b0c1e;
  --secondary-accent-color: #c5c6c7;
  --panel-border-color: #1f2833;
  --input-focus-ring-color: #66fcf1;
  --shadow-light: #1f2833;
  --shadow-dark: #020204;
}

/* Đạo Tôn */
.theme-dao-ton-premium {
    --bg-color: #F0EAD6;
    --text-color: #3A3F44;
    --text-muted-color: #7A7F84;
    --primary-accent-color: #8D7B68;
    --primary-accent-text-color: #F0EAD6;
    --secondary-accent-color: #A4907C;
    --panel-border-color: #DBD1B9;
    --input-focus-ring-color: #8D7B68;
    --shadow-light: #FFFFFF;
    --shadow-dark: #C1B59F;
}

/* Lưu Ly Ngọc Tinh (Glassmorphism) */
.theme-luu-ly-ngoc-tinh {
  --bg-color: #0D1117;
  --text-color: #E6EDF3;
  --text-muted-color: #909DAB;
  --primary-accent-color: #58A6FF;
  --primary-accent-text-color: #0D1117;
  --secondary-accent-color: #A371F7;
  --panel-border-color: rgba(255, 255, 255, 0.18);
  --input-focus-ring-color: #58A6FF;

  /* Glassmorphism specific */
  --glass-bg: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
  --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
  --glass-blur: 16px;

  /* Override Neumorphism shadows */
  --shadow-light: transparent;
  --shadow-dark: transparent;
  --shadow-raised: var(--glass-shadow);
  --shadow-raised-interactive: 0 4px 12px 0 rgba(0, 0, 0, 0.2);
  --shadow-pressed: inset 0 2px 4px 0 rgba(0, 0, 0, 0.25);
}

body {
  font-family: var(--font-family-body);
  background-color: var(--bg-color);
  color: var(--text-color);
  transition: background-color 0.5s ease;
}

* { box-sizing: border-box; }
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: var(--bg-color); }
::-webkit-scrollbar-thumb { background: var(--shadow-light); border-radius: 10px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-muted-color); }

.font-title { font-family: var(--font-family-title); }
.font-calligraphy { font-family: var(--font-family-calligraphy); }

.main-menu-title {
  font-size: clamp(4.5rem, 18vw, 11rem);
  line-height: 0.9;
  font-weight: 700;
  font-family: var(--font-family-calligraphy);
  color: var(--text-color);
  text-shadow: -2px -2px 4px var(--shadow-light), 2px 2px 4px var(--shadow-dark);
}

.panel-container {
  background-color: var(--bg-color);
  border-radius: 1.5rem;
  box-shadow: var(--shadow-raised);
  padding: 1.5rem;
}
@media (min-width: 640px) { .panel-container { padding: 2rem; } }

.btn {
  padding: 0.75rem 1.5rem;
  border-radius: 0.75rem;
  font-weight: 600;
  transition: all 0.2s ease-in-out;
  cursor: pointer;
  border: none;
  outline: none;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  position: relative;
}
.btn-primary {
  background: var(--primary-accent-color);
  color: var(--primary-accent-text-color);
  box-shadow: var(--shadow-raised-interactive);
}
.btn-primary:hover { transform: translateY(-2px); filter: brightness(1.1); }
.btn-primary:active { transform: translateY(0px); box-shadow: var(--shadow-pressed); filter: brightness(0.9); }
.btn-primary:disabled { background: #555; color: #999; box-shadow: none; cursor: not-allowed; transform: translateY(0); filter: brightness(1); }

.btn-neumorphic {
  background-color: var(--bg-color);
  color: var(--text-muted-color);
  box-shadow: var(--shadow-raised-interactive);
}
.btn-neumorphic:hover { color: var(--text-color); box-shadow: -2px -2px 5px var(--shadow-light), 2px 2px 5px var(--shadow-dark); }
.btn-neumorphic:active { color: var(--primary-accent-color); box-shadow: var(--shadow-pressed); }
.btn-neumorphic:disabled { color: #555; box-shadow: var(--shadow-pressed); cursor: not-allowed; }

.input-neumorphic {
  width: 100%;
  background-color: var(--bg-color);
  border: 1px solid transparent;
  border-radius: 0.5rem;
  padding: 0.75rem 1rem;
  color: var(--text-color);
  box-shadow: var(--shadow-pressed);
  transition: all 0.2s ease-in-out;
}
.input-neumorphic:focus { outline: none; box-shadow: var(--shadow-pressed), 0 0 0 2px var(--input-focus-ring-color); }
.input-neumorphic::placeholder { color: var(--text-muted-color); }

select.input-neumorphic {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%238A8981' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
  background-size: 1.25em 1.25em;
  color: var(--text-color);
}
select.input-neumorphic option {
  color: var(--text-color);
  background-color: var(--bg-color);
}


input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 8px;
  background: var(--bg-color);
  border-radius: 5px;
  box-shadow: var(--shadow-pressed);
}
input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 20px;
  height: 20px;
  background: var(--primary-accent-color);
  cursor: pointer;
  border-radius: 50%;
  box-shadow: var(--shadow-raised-interactive);
}
input[type="range"]::-moz-range-thumb {
  width: 20px;
  height: 20px;
  background: var(--primary-accent-color);
  cursor: pointer;
  border-radius: 50%;
  border: none;
  box-shadow: var(--shadow-raised-interactive);
}

.modal-overlay {
  position: fixed; inset: 0; z-index: 50; display: flex; align-items: center;
  justify-content: center; background-color: rgba(0,0,0,0.7);
  backdrop-filter: blur(8px); animation: fade-in 0.3s ease-out;
}
.modal-content {
  background-color: var(--bg-color); border-radius: 1rem;
  box-shadow: var(--shadow-raised); width: 100%; max-width: 42rem;
  margin: 1rem; display: flex; flex-direction: column; max-height: 90vh;
}
.modal-body { padding: 1.5rem; overflow-y: auto; flex-grow: 1; }
.modal-footer { padding: 1rem 1.5rem; border-top: 1px solid var(--shadow-light); display: flex; justify-content: flex-end; gap: 0.75rem; }

/* General Purpose Neumorphic Containers */
.neumorphic-inset-box {
  background-color: var(--bg-color);
  padding: 0.75rem;
  border-radius: 0.75rem;
  box-shadow: var(--shadow-pressed);
}

/* Game Play Specifics */
.player-bubble, .npc-bubble {
  background-color: var(--bg-color);
  padding: 0.75rem 1rem;
  box-shadow: var(--shadow-pressed);
}
.player-bubble { border-radius: 1rem 1rem 0.25rem 1rem; }
.npc-bubble { border-radius: 1rem 1rem 1rem 0.25rem; }

/* --- Glassmorphism Theme Overrides --- */
.theme-luu-ly-ngoc-tinh .panel-container,
.theme-luu-ly-ngoc-tinh .neumorphic-inset-box,
.theme-luu-ly-ngoc-tinh .btn-neumorphic,
.theme-luu-ly-ngoc-tinh .input-neumorphic,
.theme-luu-ly-ngoc-tinh .player-bubble,
.theme-luu-ly-ngoc-tinh .npc-bubble,
.theme-luu-ly-ngoc-tinh .modal-content {
  background: var(--glass-bg);
  backdrop-filter: blur(var(--glass-blur));
  -webkit-backdrop-filter: blur(var(--glass-blur));
  border: 1px solid var(--panel-border-color);
}

.theme-luu-ly-ngoc-tinh .panel-container,
.theme-luu-ly-ngoc-tinh .modal-content {
  box-shadow: var(--shadow-raised);
}

.theme-luu-ly-ngoc-tinh .input-neumorphic,
.theme-luu-ly-ngoc-tinh .neumorphic-inset-box,
.theme-luu-ly-ngoc-tinh .player-bubble,
.theme-luu-ly-ngoc-tinh .npc-bubble {
   box-shadow: var(--shadow-pressed);
}

.theme-luu-ly-ngoc-tinh .input-neumorphic:focus {
   box-shadow: var(--shadow-pressed), 0 0 0 2px var(--input-focus-ring-color);
   background: rgba(255, 255, 255, 0.1);
}

.theme-luu-ly-ngoc-tinh .btn-neumorphic {
  box-shadow: var(--shadow-raised-interactive);
}
.theme-luu-ly-ngoc-tinh .btn-neumorphic:hover {
  background: rgba(255, 255, 255, 0.15);
  border-color: rgba(255, 255, 255, 0.2);
  transform: translateY(-2px);
  color: var(--text-color);
}
.theme-luu-ly-ngoc-tinh .btn-neumorphic:active {
  background: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.15);
  transform: translateY(0);
  box-shadow: var(--shadow-pressed);
  color: var(--primary-accent-color);
}

.theme-luu-ly-ngoc-tinh .main-menu-title {
    text-shadow: 0 4px 20px rgba(0,0,0,0.5);
}

/* Dynamic & Special Effects */
.dynamic-bg-container { position: fixed; inset: 0; z-index: -10; overflow: hidden; background-color: var(--bg-color); }
.dynamic-bg-layer { position: absolute; inset: 0; background-size: auto 100%; background-repeat: repeat-x; background-position: center bottom; will-change: transform; }
@keyframes parallax-scroll { from { transform: translateX(0); } to { transform: translateX(-1920px); } }
.layer-1 { animation: parallax-scroll 240s linear infinite; }
.layer-2 { animation: parallax-scroll 180s linear infinite; }
.layer-3 { animation: parallax-scroll 120s linear infinite; }
.layer-4 { animation: parallax-scroll 80s linear infinite; }

.particle-container { position: fixed; inset: 0; z-index: -5; pointer-events: none; }
.particle { position: absolute; background-color: rgba(212, 175, 55, 0.4); border-radius: 50%; animation: float-particle linear infinite; box-shadow: 0 0 5px rgba(212, 175, 55, 0.3); }
@keyframes float-particle { 0% { transform: translateY(100vh) scale(0); opacity: 0; } 10%, 90% { opacity: 1; } 100% { transform: translateY(-10vh) scale(1); opacity: 0; } }

.weather-overlay { position: fixed; inset: 0; z-index: -1; pointer-events: none; opacity: 0; transition: opacity 1s ease-in-out; }
.weather-overlay.active { opacity: 1; }
.rain-container { position: absolute; inset: 0; overflow: hidden; }
.raindrop { position: absolute; bottom: 100%; width: 1.5px; background: linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,0.4) 100%); animation: fall linear infinite; }
@keyframes fall { to { transform: translateY(110vh); } }
.storm-flash { position: absolute; inset: 0; background-color: rgba(200, 200, 255, 0.6); opacity: 0; animation: storm-flash-anim 10s infinite; animation-delay: 2s; }
@keyframes storm-flash-anim { 0%, 100% { opacity: 0; } 1%, 5%, 8% { opacity: 1; } 1.5%, 5.5%, 8.5% { opacity: 0; } }
.snow-container { position: absolute; inset: 0; overflow: hidden; }
.snowflake { position: absolute; top: -10px; background-color: #fff; border-radius: 50%; animation: snowfall linear infinite; }
@keyframes snowfall { 0% { transform: translateY(0) translateX(0); } 100% { transform: translateY(105vh) translateX(var(--sway-x)); } }

/* Ink Splatter Effect for Thuy Mac Theme */
.ink-splatter-container {
  position: fixed;
  inset: 0;
  z-index: -4;
  pointer-events: none;
  overflow: hidden;
}
.ink-splatter {
  position: absolute;
  background-color: rgba(0, 0, 0, 0.7);
  border-radius: 50%;
  filter: url(#ink-wash) blur(1px);
  opacity: 0;
  animation: ink-fade-in-out ease-in-out infinite alternate;
}
@keyframes ink-fade-in-out {
  from { 
    opacity: 0; 
    transform: scale(0.8) rotate(0deg); 
  }
  to { 
    opacity: 0.1; 
    transform: scale(1.1) rotate(180deg); 
  }
}

/* --- Genre Theming --- */
body.genre-khoa-huyen-vien-tuong,
body.genre-cyber-tu-chan,
body.genre-steampunk-ma-thu-thuat {
  --font-family-body: 'Orbitron', sans-serif;
  --font-family-title: 'Orbitron', sans-serif;
}

.scanlines-overlay {
    position: fixed;
    inset: 0;
    z-index: -2;
    pointer-events: none;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
    background-size: 100% 4px, 6px 100%;
    animation: scanlines-anim 5s linear infinite;
}

@keyframes scanlines-anim {
    from { background-position: 0 0; }
    to { background-position: 0 200%; }
}


/* Keyframe Animations */
.animate-fade-in { animation: fade-in 0.5s ease-out forwards; }
.animate-fade-in-menu { animation: fade-in-menu 0.8s ease-out forwards; }
.animate-menu-item { opacity: 0; transform: translateY(20px); animation: menu-item-appear 0.6s ease-out forwards; }
@keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
@keyframes fade-in-menu { from { opacity: 0; } to { opacity: 1; } }
@keyframes menu-item-appear { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

/* Gemini UI Theme for Novelist (unchanged) */
.gemini-theme { --gemini-bg: #131314; --gemini-text: #e3e3e3; --gemini-text-muted: #94999d; --gemini-surface: #1e1f20; --gemini-surface-subtle: #18191a; --gemini-input-bg: #1e1f20; --gemini-border: #3c4043; --gemini-accent: #8ab4f8; }
.gemini-theme { background-color: var(--gemini-bg); color: var(--gemini-text); font-family: 'Noto Serif', sans-serif; }
.gemini-title-gradient { background: -webkit-linear-gradient(135deg, #4285f4, #9b72cb, #d96570, #f2994a); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.gemini-prompt-card { background-color: var(--gemini-surface); padding: 1rem; border-radius: 0.75rem; border: 1px solid var(--gemini-border); text-align: left; transition: background-color 0.2s; font-size: 0.875rem; }
.gemini-prompt-card:hover { background-color: rgba(255, 255, 255, 0.05); }
.gemini-message-container .prose { color: var(--gemini-text); max-width: 100%; font-size: 1rem; line-height: 1.75; }
.gemini-message-container .prose h1, .gemini-message-container .prose h2, .gemini-message-container .prose h3 { color: var(--gemini-text); border-bottom: 1px solid var(--gemini-border); padding-bottom: 0.5em; margin-top: 1.5em; margin-bottom: 1em; }
.gemini-message-container .prose strong { color: #f0f0f0; }
.gemini-message-container .prose ul { list-style-position: inside; padding-left: 0; }
.gemini-message-container .prose ul li { margin-top: 0.25em; }
.gemini-input-container { padding: 0.5rem 1rem 1rem 1rem; width: 100%; max-width: 56rem; margin: 0 auto; }
.gemini-input-bar { display: flex; align-items: flex-end; background-color: var(--gemini-input-bg); border: 1px solid var(--gemini-border); border-radius: 1.5rem; padding: 0.5rem 0.5rem 0.5rem 1rem; }
.gemini-textarea { flex-grow: 1; background: transparent; border: none; outline: none; resize: none; color: var(--gemini-text); font-size: 1rem; line-height: 1.5; max-height: 200px; overflow-y: auto; }
.gemini-textarea::placeholder { color: var(--gemini-text-muted); }
.gemini-textarea:disabled { background-color: transparent; }
.gemini-send-button { flex-shrink: 0; width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; background-color: var(--gemini-surface); transition: background-color 0.2s; border: none; }
.gemini-send-button:not(:disabled) { background-color: var(--gemini-accent); color: var(--gemini-bg); cursor: pointer; }
.gemini-send-button:disabled { cursor: not-allowed; color: var(--gemini-text-muted); }
.gemini-loader { width: 1rem; height: 1rem; border: 2px solid var(--gemini-text-muted); border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }